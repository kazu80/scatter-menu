<link rel="import" href="../polymer/polymer-element.html">

<dom-module id="scatter-menu-item">
    <template>
        <style>
            :host {
                --menu-order  : 1;
                --menu-column : 0;
                --menu-size   : 50%;
                --item-size   : 50px;
                --space-size  : 20px;
            }

            button:focus,
            button:active {
                outline : none;
            }

            .item {
                position         : absolute;
                top              : 0;
                left             : 0;
                width            : var(--item-size);
                height           : var(--item-size);
                border           : 1px solid #000000;
                border-radius    : 50%;
                background-color : #f8c555;
                filter           : brightness(1.0);
                transition       : all 800ms ease;
            }

            .item.active {
                top  : calc(((var(--item-size) * var(--menu-column)) + (var(--space-size) * var(--menu-column))));
                left : calc((var(--item-size) * (var(--menu-order) - 1)) + (var(--space-size) * (var(--menu-order) - 1)));
            }

            .flash {
                animation : flash 200ms ease;
            }

            @keyframes flash {
                0%, 100% {
                    filter : brightness(1.0);
                }
                50% {
                    filter : brightness(1.5);
                }
            }


        </style>
        <button id="item" class="item"></button>
    </template>
    <script>
        /**
         * `scatter-menu-item`
         *
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */
        class ScatterMenuItem extends Polymer.Element {
            static get is () { return 'scatter-menu-item'; }

            static get properties () {
                return {
                    menuOrder    : {
                        type    : Number,
                        observer: '_setOrder'
                    },
                    menuColumn   : {
                        type    : Number,
                        value   : 1,
                        observer: '_setColumn'
                    },
                    menuSpace    : {
                        type    : Number,
                        value   : 20,
                        observer: '_setSpace'
                    },
                    scatterActive: {
                        type    : String,
                        observer: '_active'
                    }
                };
            }

            ready () {
                super.ready ();

                this._setEvent ();
            }

            _setEvent () {
                this.$.item.addEventListener ('click', () => {
                    // effect
                    this.$.item.classList.add ('flash');
                    this.$.item.addEventListener ('animationend', () => this.$.item.classList.remove ('flash'));

                    //
                    const id = this.getAttribute ('name');
                    this.dispatchEvent (
                        new CustomEvent ('menuSelected', {bubbles: true, composed: true, detail: {selected: id}}));
                });
            }

            _setOrder (val, order) {
                this.style.setProperty ('--menu-order', val);
            }

            _setColumn (val, order) {
                this.style.setProperty ('--menu-column', val - 1);
            }

            _setSpace (val, order) {
                this.style.setProperty ('--space-size', `${val}px`);
            }

            _active (val, order) {
                if (order === undefined) {
                    return;
                }
                if (val === 'true') {
                    this.$.item.classList.add ('active');
                } else {
                    this.$.item.classList.remove ('active');
                }
            }
        }

        window.customElements.define (ScatterMenuItem.is, ScatterMenuItem);
    </script>
</dom-module>
